diff -up gtk+-3.22.30/gtk/gtkprivate.c.omv~ gtk+-3.22.30/gtk/gtkprivate.c
--- gtk+-3.22.30/gtk/gtkprivate.c.omv~	2018-12-16 02:05:09.333462118 +0100
+++ gtk+-3.22.30/gtk/gtkprivate.c	2018-12-16 02:08:36.946302624 +0100
@@ -271,23 +271,9 @@ _gtk_ensure_resources (void)
 gboolean
 gtk_should_use_portal (void)
 {
-  static const char *use_portal = NULL;
-
-  if (G_UNLIKELY (use_portal == NULL))
-    {
-      char *path;
-
-      path = g_build_filename (g_get_user_runtime_dir (), "flatpak-info", NULL);
-      if (g_file_test (path, G_FILE_TEST_EXISTS))
-        use_portal = "1";
-      else
-        {
-          use_portal = g_getenv ("GTK_USE_PORTAL");
-          if (!use_portal)
-            use_portal = "";
-        }
-      g_free (path);
-    }
-
-  return use_portal[0] == '1';
+  static const char *use_portal = NULL;
+  use_portal = g_getenv ("GTK_USE_PORTAL");
+  if (use_portal && use_portal[0] == '0')
+    return 0;
+  return 1;
 }
diff -up gtk+-3.22.30/testsuite/gtk/gtkprivate.c.omv~ gtk+-3.22.30/testsuite/gtk/gtkprivate.c
--- gtk+-3.22.30/testsuite/gtk/gtkprivate.c.omv~	2018-12-16 02:07:35.322460694 +0100
+++ gtk+-3.22.30/testsuite/gtk/gtkprivate.c	2018-12-16 02:08:20.674080392 +0100
@@ -271,23 +271,9 @@ _gtk_ensure_resources (void)
 gboolean
 gtk_should_use_portal (void)
 {
-  static const char *use_portal = NULL;
-
-  if (G_UNLIKELY (use_portal == NULL))
-    {
-      char *path;
-
-      path = g_build_filename (g_get_user_runtime_dir (), "flatpak-info", NULL);
-      if (g_file_test (path, G_FILE_TEST_EXISTS))
-        use_portal = "1";
-      else
-        {
-          use_portal = g_getenv ("GTK_USE_PORTAL");
-          if (!use_portal)
-            use_portal = "";
-        }
-      g_free (path);
-    }
-
-  return use_portal[0] == '1';
+  static const char *use_portal = NULL;
+  use_portal = g_getenv ("GTK_USE_PORTAL");
+  if (use_portal && use_portal[0] == '0')
+    return 0;
+  return 1;
 }
